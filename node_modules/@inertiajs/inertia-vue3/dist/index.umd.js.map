{"version":3,"file":"index.umd.js","sources":["../src/link.js","../src/remember.js","../src/app.js"],"sourcesContent":["import { h } from 'vue'\nimport { hrefToUrl, Inertia, mergeDataIntoQueryString, shouldIntercept } from '@inertiajs/inertia'\n\nexport default {\n  props: {\n    as: {\n      type: String,\n      default: 'a',\n    },\n    data: {\n      type: Object,\n      default: () => ({}),\n    },\n    href: {\n      type: String,\n      required: true,\n    },\n    method: {\n      type: String,\n      default: 'get',\n    },\n    replace: {\n      type: Boolean,\n      default: false,\n    },\n    preserveScroll: {\n      type: Boolean,\n      default: false,\n    },\n    preserveState: {\n      type: Boolean,\n      default: null,\n    },\n    only: {\n      type: Array,\n      default: () => [],\n    },\n    headers: {\n      type: Object,\n      default: () => ({}),\n    },\n  },\n  setup(props, { slots, attrs }) {\n    return props => {\n      const as = props.as.toLowerCase()\n      const method = props.method.toLowerCase()\n      const [url, data] = mergeDataIntoQueryString(method, hrefToUrl(props.href), props.data)\n\n      if (as === 'a' && method !== 'get') {\n        console.warn(`Creating POST/PUT/PATCH/DELETE <a> links is discouraged as it causes \"Open Link in New Tab/Window\" accessibility issues.\\n\\nPlease specify a more appropriate element using the \"as\" attribute. For example:\\n\\n<inertia-link href=\"${url.href}\" method=\"${method}\" as=\"button\">...</inertia-link>`)\n      }\n\n      return h(props.as, {\n        ...attrs,\n        ...as === 'a' ? { href: url.href } : {},\n        onClick: (event) => {\n          if (shouldIntercept(event)) {\n            event.preventDefault()\n\n            Inertia.visit(url.href, {\n              data: data,\n              method: method,\n              replace: props.replace,\n              preserveScroll: props.preserveScroll,\n              preserveState: props.preserveState ?? (method !== 'get'),\n              only: props.only,\n              headers: props.headers,\n              onCancelToken: attrs.onCancelToken || (() => ({})),\n              onBefore: attrs.onBefore || (() => ({})),\n              onStart: attrs.onStart || (() => ({})),\n              onProgress: attrs.onProgress || (() => ({})),\n              onFinish: attrs.onFinish || (() => ({})),\n              onCancel: attrs.onCancel || (() => ({})),\n              onSuccess: attrs.onSuccess || (() => ({})),\n            })\n          }\n        },\n      }, slots.default())\n    }\n  },\n}\n","import { Inertia } from '@inertiajs/inertia'\n\nexport default {\n  created() {\n    if (!this.$options.remember) {\n      return\n    }\n\n    if (Array.isArray(this.$options.remember)) {\n      this.$options.remember = { data: this.$options.remember }\n    }\n\n    if (typeof this.$options.remember === 'string') {\n      this.$options.remember = { data: [this.$options.remember] }\n    }\n\n    if (typeof this.$options.remember.data === 'string') {\n      this.$options.remember = { data: [this.$options.remember.data] }\n    }\n\n    const stateKey = this.$options.remember.key instanceof Function\n      ? this.$options.remember.key.call(this)\n      : this.$options.remember.key\n\n    const restored = Inertia.restore(stateKey)\n\n    this.$options.remember.data.forEach(key => {\n      if (restored !== undefined && restored[key] !== undefined) {\n        this[key] = restored[key]\n      }\n\n      this.$watch(key, () => {\n        Inertia.remember(\n          this.$options.remember.data.reduce((data, key) => ({ ...data, [key]: JSON.parse(JSON.stringify(this[key])) }), {}),\n          stateKey,\n        )\n      }, { immediate: true, deep: true })\n    })\n  },\n}\n","import link from './link'\nimport remember from './remember'\nimport { computed, h, markRaw, ref } from 'vue'\nimport { Inertia } from '@inertiajs/inertia'\n\nconst component = ref(null)\nconst page = ref({})\nconst key = ref(null)\n\nexport default {\n  name: 'Inertia',\n  props: {\n    initialPage: {\n      type: Object,\n      required: true,\n    },\n    resolveComponent: {\n      type: Function,\n      required: true,\n    },\n    transformProps: {\n      type: Function,\n      default: props => props,\n    },\n  },\n  setup({ initialPage, resolveComponent, transformProps }) {\n    Inertia.init({\n      initialPage,\n      resolveComponent,\n      transformProps,\n      swapComponent: async (args) => {\n        component.value = markRaw(args.component)\n        page.value = args.page\n        key.value = args.preserveState ? key.value : Date.now()\n      },\n    })\n\n    return () => {\n      if (component.value) {\n        const child = h(component.value, {\n          ...page.value.props,\n          key: key.value,\n        })\n\n        if (component.value.layout) {\n          if (typeof component.value.layout === 'function') {\n            return component.value.layout(h, child)\n          } else if (Array.isArray(component.value.layout)) {\n            return component.value.layout\n              .concat(child)\n              .reverse()\n              .reduce((child, layout) => h(layout, [child]))\n          }\n\n          return h(component.value.layout, () => child)\n        }\n\n        return child\n      }\n    }\n  }\n}\n\nexport const plugin = {\n  install(app) {\n    Object.defineProperty(app.config.globalProperties, '$inertia', { get: () => Inertia })\n    Object.defineProperty(app.config.globalProperties, '$page', { get: () => page.value })\n    app.mixin(remember)\n    app.component('InertiaLink', link)\n  },\n}\n\nexport function usePage() {\n  return {\n    props: computed(() => page.value.props),\n    url: computed(() => page.value.url),\n    component: computed(() => page.value.component),\n    version: computed(() => page.value.version),\n  }\n}\n"],"names":["props","as","type","String","default","data","Object","href","required","method","replace","Boolean","preserveScroll","preserveState","only","Array","headers","setup","slots","attrs","toLowerCase","mergeDataIntoQueryString","hrefToUrl","url","console","warn","h","onClick","event","shouldIntercept","preventDefault","Inertia","visit","onCancelToken","onBefore","onStart","onProgress","onFinish","onCancel","onSuccess","created","this","$options","remember","isArray","stateKey","key","Function","call","restored","restore","forEach","undefined","_this","$watch","reduce","JSON","parse","stringify","immediate","deep","component","ref","page","name","initialPage","resolveComponent","transformProps","init","swapComponent","args","value","markRaw","Date","now","child","layout","concat","reverse","plugin","install","app","defineProperty","config","globalProperties","get","mixin","link","computed","version"],"mappings":"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"}