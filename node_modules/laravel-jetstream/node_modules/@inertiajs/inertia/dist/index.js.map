{"version":3,"file":"index.js","sources":["../src/modal.js","../src/inertia.js","../src/debounce.js","../src/should-intercept.js"],"sourcesContent":["export default {\n  modal: null,\n  listener: null,\n\n  show(html) {\n    if (typeof html === 'object') {\n      html = `All Inertia requests must receive a valid Inertia response, however a plain JSON response was received.<hr>${JSON.stringify(html)}`\n    }\n\n    let page = document.createElement('html')\n    page.innerHTML = html\n    page.querySelectorAll('a').forEach(a => a.setAttribute('target', '_top'))\n\n    this.modal = document.createElement('div')\n    this.modal.style.position = 'fixed'\n    this.modal.style.width = '100vw'\n    this.modal.style.height = '100vh'\n    this.modal.style.padding = '50px'\n    this.modal.style.boxSizing = 'border-box'\n    this.modal.style.backgroundColor = 'rgba(0, 0, 0, .6)'\n    this.modal.style.zIndex = 200000\n    this.modal.addEventListener('click', () => this.hide())\n\n    let iframe = document.createElement('iframe')\n    iframe.style.backgroundColor = 'white'\n    iframe.style.borderRadius = '5px'\n    iframe.style.width = '100%'\n    iframe.style.height = '100%'\n    this.modal.appendChild(iframe)\n\n    document.body.prepend(this.modal)\n    document.body.style.overflow = 'hidden'\n    iframe.contentWindow.document.open()\n    iframe.contentWindow.document.write(page.outerHTML)\n    iframe.contentWindow.document.close()\n\n    this.listener = this.hideOnEscape.bind(this)\n    document.addEventListener('keydown', this.listener)\n  },\n\n  hide() {\n    this.modal.outerHTML = ''\n    this.modal = null\n    document.body.style.overflow = 'visible'\n    document.removeEventListener('keydown', this.listener)\n  },\n\n  hideOnEscape(event) {\n    if (event.keyCode === 27) {\n      this.hide()\n    }\n  },\n}\n","import Axios from 'axios'\nimport debounce from './debounce'\nimport modal from './modal'\n\nexport default {\n  resolveComponent: null,\n  swapComponent: null,\n  transformProps: null,\n  cancelToken: null,\n  visitId: null,\n  page: null,\n\n  init({ initialPage, resolveComponent, swapComponent, transformProps }) {\n    this.resolveComponent = resolveComponent\n    this.swapComponent = swapComponent\n    this.transformProps = transformProps\n    this.handleInitialPageVisit(initialPage)\n    this.setupEventListeners()\n  },\n\n  handleInitialPageVisit(page) {\n    if (this.isBackForwardVisit()) {\n      this.handleBackForwardVisit(page)\n    } else if (this.isLocationVisit()) {\n      this.handleLocationVisit(page)\n    } else {\n      page.url += window.location.hash\n      this.setPage(page)\n    }\n    this.fireEvent('navigate', { detail: { page: page } })\n  },\n\n  setupEventListeners() {\n    window.addEventListener('popstate', this.handlePopstateEvent.bind(this))\n    document.addEventListener('scroll', debounce(this.handleScrollEvent.bind(this), 100), true)\n  },\n\n  scrollRegions() {\n    return document.querySelectorAll('[scroll-region]')\n  },\n\n  handleScrollEvent(event) {\n    if (typeof event.target.hasAttribute === 'function' && event.target.hasAttribute('scroll-region')) {\n      this.saveScrollPositions()\n    }\n  },\n\n  saveScrollPositions() {\n    this.replaceState({\n      ...this.page,\n      scrollRegions: Array.prototype.slice.call(this.scrollRegions()).map(region => {\n        return {\n          top: region.scrollTop,\n          left: region.scrollLeft,\n        }\n      }),\n    })\n  },\n\n  resetScrollPositions() {\n    document.documentElement.scrollTop = 0\n    document.documentElement.scrollLeft = 0\n    this.scrollRegions().forEach(region => {\n      region.scrollTop = 0\n      region.scrollLeft = 0\n    })\n    this.saveScrollPositions()\n\n    if (window.location.hash) {\n      document.getElementById(window.location.hash.slice(1))?.scrollIntoView()\n    }\n  },\n\n  restoreScrollPositions() {\n    if (this.page.scrollRegions) {\n      this.scrollRegions().forEach((region, index) => {\n        region.scrollTop = this.page.scrollRegions[index].top\n        region.scrollLeft = this.page.scrollRegions[index].left\n      })\n    }\n  },\n\n  isBackForwardVisit() {\n    return window.history.state\n      && window.performance\n      && window.performance.getEntriesByType('navigation').length\n      && window.performance.getEntriesByType('navigation')[0].type === 'back_forward'\n  },\n\n  handleBackForwardVisit(page) {\n    window.history.state.version = page.version\n    this.setPage(window.history.state, { preserveScroll: true }).then(() => {\n      this.restoreScrollPositions()\n    })\n  },\n\n  locationVisit(url, preserveScroll) {\n    try {\n      window.sessionStorage.setItem('inertiaLocationVisit', JSON.stringify({ preserveScroll }))\n      window.location.href = url.href\n      if (this.urlWithoutHash(window.location).href === this.urlWithoutHash(url).href) {\n        window.location.reload()\n      }\n    } catch (error) {\n      return false\n    }\n  },\n\n  isLocationVisit() {\n    try {\n      return window.sessionStorage.getItem('inertiaLocationVisit') !== null\n    } catch (error) {\n      return false\n    }\n  },\n\n  handleLocationVisit(page) {\n    const locationVisit = JSON.parse(window.sessionStorage.getItem('inertiaLocationVisit'))\n    window.sessionStorage.removeItem('inertiaLocationVisit')\n    page.url += window.location.hash\n    page.rememberedState = window.history.state?.rememberedState ?? {}\n    page.scrollRegions = window.history.state?.scrollRegions ?? []\n    this.setPage(page, { preserveScroll: locationVisit.preserveScroll }).then(() => {\n      if (locationVisit.preserveScroll) {\n        this.restoreScrollPositions()\n      }\n    })\n  },\n\n  isLocationVisitResponse(response) {\n    return response && response.status === 409 && response.headers['x-inertia-location']\n  },\n\n  isInertiaResponse(response) {\n    return response?.headers['x-inertia']\n  },\n\n  cancelActiveVisits() {\n    if (this.cancelToken) {\n      this.cancelToken.cancel()\n    }\n    this.cancelToken = Axios.CancelToken.source()\n  },\n\n  createVisitId() {\n    this.visitId = {}\n    return this.visitId\n  },\n\n  normalizeUrl(url) {\n    try {\n      if (url.startsWith('#')) {\n        return new URL(`${this.urlWithoutHash(window.location)}${url}`)\n      } else {\n        return new URL(url)\n      }\n    } catch (error) {\n      return new URL(`${window.location.origin}${url}`)\n    }\n  },\n\n  urlWithoutHash(url) {\n    url = new URL(url.href)\n    url.hash = ''\n    return url\n  },\n\n  visit(url, {\n    method = 'get',\n    data = {},\n    replace = false,\n    preserveScroll = false,\n    preserveState = false,\n    only = [],\n    headers = {},\n    onCancelToken = () => ({}),\n    onStart = () => ({}),\n    onProgress = () => ({}),\n    onFinish = () => ({}),\n    onCancel = () => ({}),\n    onSuccess = () => ({}),\n  } = {}) {\n    url = this.normalizeUrl(url)\n    let visit = { url, ...arguments[1] }\n    if (onStart(visit) === false || !this.fireEvent('start', { cancelable: true, detail: { visit } } )) {\n      return\n    }\n    this.cancelActiveVisits()\n    this.saveScrollPositions()\n    let visitId = this.createVisitId()\n    onCancelToken(this.cancelToken)\n\n    return new Proxy(\n      Axios({\n        method,\n        url: this.urlWithoutHash(url).href,\n        data: method.toLowerCase() === 'get' ? {} : data,\n        params: method.toLowerCase() === 'get' ? data : {},\n        cancelToken: this.cancelToken.token,\n        headers: {\n          ...headers,\n          Accept: 'text/html, application/xhtml+xml',\n          'X-Requested-With': 'XMLHttpRequest',\n          'X-Inertia': true,\n          ...(only.length ? {\n            'X-Inertia-Partial-Component': this.page.component,\n            'X-Inertia-Partial-Data': only.join(','),\n          } : {}),\n          ...(this.page.version ? { 'X-Inertia-Version': this.page.version } : {}),\n        },\n        onUploadProgress: progress => {\n          progress.percentage = Math.round(progress.loaded / progress.total * 100)\n          this.fireEvent('progress', { detail: { progress } })\n          onProgress(progress)\n        },\n      }).then(response => {\n        if (!this.isInertiaResponse(response)) {\n          return Promise.reject({ response })\n        }\n        if (only.length && response.data.component === this.page.component) {\n          response.data.props = { ...this.page.props, ...response.data.props }\n        }\n        const responseUrl = this.normalizeUrl(response.data.url)\n        if (url.hash && !responseUrl.hash && this.urlWithoutHash(url).href === responseUrl.href) {\n          responseUrl.hash = url.hash\n          response.data.url = responseUrl.href\n        }\n        return this.setPage(response.data, { visitId, replace, preserveScroll, preserveState })\n      }).then(() => {\n        this.fireEvent('success', { detail: { page: this.page } })\n        return onSuccess(this.page)\n      }).catch(error => {\n        if (this.isInertiaResponse(error.response)) {\n          return this.setPage(error.response.data, { visitId })\n        } else if (Axios.isCancel(error)) {\n          onCancel()\n        } else if (this.isLocationVisitResponse(error.response)) {\n          let locationUrl = this.normalizeUrl(error.response.headers['x-inertia-location'])\n          if (url.hash && !locationUrl.hash && this.urlWithoutHash(url).href === locationUrl.href) {\n            locationUrl.hash = url.hash\n          }\n          this.locationVisit(locationUrl, preserveScroll)\n        } else if (error.response) {\n          if (this.fireEvent('invalid', { cancelable: true, detail: { response: error.response } })) {\n            modal.show(error.response.data)\n          }\n        } else {\n          return Promise.reject(error)\n        }\n      }).catch(error => {\n        if (this.fireEvent('error', { cancelable: true, detail: { error } })) {\n          return Promise.reject(error)\n        }\n      }).finally(() => {\n        this.fireEvent('finish')\n        onFinish()\n      }), {\n        get: function(target, prop) {\n          if (['then', 'catch', 'finally'].includes(prop)) {\n            console.warn('Inertia.js visit promises have been deprecated and will be removed in a future release. Please use the new visit event callbacks instead.\\n\\nLearn more at https://inertiajs.com/manual-visits#promise-deprecation')\n          }\n          return typeof target[prop] === 'function'\n            ? target[prop].bind(target)\n            : target[prop]\n        },\n      },\n    )\n  },\n\n  setPage(page, { visitId = this.createVisitId(), replace = false, preserveScroll = false, preserveState = false } = {}) {\n    return Promise.resolve(this.resolveComponent(page.component)).then(component => {\n      if (visitId === this.visitId) {\n        page.props = this.transformProps(page.props)\n        page.scrollRegions = page.scrollRegions || []\n        page.rememberedState = page.rememberedState || {}\n        preserveState = typeof preserveState === 'function' ? preserveState(page) : preserveState\n        preserveScroll = typeof preserveScroll === 'function' ? preserveScroll(page) : preserveScroll\n        replace = replace || this.normalizeUrl(page.url).href === window.location.href\n        replace ? this.replaceState(page) : this.pushState(page)\n        this.swapComponent({ component, page, preserveState }).then(() => {\n          if (!preserveScroll) {\n            this.resetScrollPositions()\n          }\n          if (!replace) {\n            this.fireEvent('navigate', { detail: { page: page } })\n          }\n        })\n      }\n    })\n  },\n\n  pushState(page) {\n    this.page = page\n    window.history.pushState(page, '', page.url)\n  },\n\n  replaceState(page) {\n    this.page = page\n    window.history.replaceState(page, '', page.url)\n  },\n\n  handlePopstateEvent(event) {\n    if (event.state !== null) {\n      const page = event.state\n      let visitId = this.createVisitId()\n      return Promise.resolve(this.resolveComponent(page.component)).then(component => {\n        if (visitId === this.visitId) {\n          this.page = page\n          this.swapComponent({ component, page, preserveState: false }).then(() => {\n            this.restoreScrollPositions()\n            this.fireEvent('navigate', { detail: { page: page } })\n          })\n        }\n      })\n    } else {\n      const url = this.normalizeUrl(this.page.url)\n      url.hash = window.location.hash\n      this.replaceState({ ...this.page, url: url.href })\n      this.resetScrollPositions()\n    }\n  },\n\n  get(url, data = {}, options = {}) {\n    return this.visit(url, { ...options, method: 'get', data })\n  },\n\n  reload(options = {}) {\n    return this.replace(window.location.href, options)\n  },\n\n  replace(url, options = {}) {\n    return this.visit(url, { preserveState: true, ...options, replace: true })\n  },\n\n  post(url, data = {}, options = {}) {\n    return this.visit(url, { preserveState: true, ...options, method: 'post', data })\n  },\n\n  put(url, data = {}, options = {}) {\n    return this.visit(url, { preserveState: true, ...options, method: 'put', data })\n  },\n\n  patch(url, data = {}, options = {}) {\n    return this.visit(url, { preserveState: true, ...options, method: 'patch', data })\n  },\n\n  delete(url, options = {}) {\n    return this.visit(url, { preserveState: true, ...options, method: 'delete' })\n  },\n\n  remember(data, key = 'default') {\n    this.replaceState({\n      ...this.page,\n      rememberedState: {\n        ...this.page.rememberedState,\n        [key]: data,\n      },\n    })\n  },\n\n  restore(key = 'default') {\n    return window.history.state?.rememberedState?.[key]\n  },\n\n  fireEvent(name, options) {\n    return document.dispatchEvent(\n      new CustomEvent(`inertia:${name}`, options),\n    )\n  },\n\n  on(type, callback) {\n    const listener = event => {\n      const response = callback(event)\n      if (event.cancelable && !event.defaultPrevented && response === false) {\n        event.preventDefault()\n      }\n    }\n\n    document.addEventListener(`inertia:${type}`, listener)\n    return () => document.removeEventListener(`inertia:${type}`, listener)\n  },\n}\n","export default function debounce(fn, delay) {\n  let timeoutID = null\n  return function () {\n    clearTimeout(timeoutID)\n    timeoutID = setTimeout(() => fn.apply(this, arguments), delay)\n  }\n}\n","export default function shouldIntercept(event) {\n  return !(\n    (event.target && event.target.isContentEditable)\n    || event.defaultPrevented\n    || event.which > 1\n    || event.altKey\n    || event.ctrlKey\n    || event.metaKey\n    || event.shiftKey\n  )\n}\n"],"names":["modal","listener","show","html","JSON","stringify","page","document","createElement","innerHTML","querySelectorAll","forEach","a","setAttribute","this","style","position","width","height","padding","boxSizing","backgroundColor","zIndex","addEventListener","_this","hide","iframe","borderRadius","appendChild","body","prepend","overflow","contentWindow","open","write","outerHTML","close","hideOnEscape","bind","removeEventListener","event","keyCode","resolveComponent","swapComponent","transformProps","cancelToken","visitId","init","initialPage","handleInitialPageVisit","setupEventListeners","isBackForwardVisit","handleBackForwardVisit","isLocationVisit","handleLocationVisit","url","window","location","hash","setPage","fireEvent","detail","fn","timeoutID","handlePopstateEvent","handleScrollEvent","clearTimeout","setTimeout","apply","arguments","scrollRegions","target","hasAttribute","saveScrollPositions","replaceState","Array","prototype","slice","call","map","region","top","scrollTop","left","scrollLeft","resetScrollPositions","documentElement","getElementById","scrollIntoView","restoreScrollPositions","index","history","state","performance","getEntriesByType","length","type","version","preserveScroll","then","_this2","locationVisit","sessionStorage","setItem","href","urlWithoutHash","reload","error","getItem","parse","removeItem","rememberedState","_window$history$state2","_window$history$state4","_this3","isLocationVisitResponse","response","status","headers","isInertiaResponse","cancelActiveVisits","cancel","Axios","CancelToken","source","createVisitId","normalizeUrl","startsWith","URL","origin","visit","method","data","replace","preserveState","only","onCancelToken","onStart","onProgress","onFinish","onCancel","onSuccess","cancelable","Proxy","toLowerCase","params","token","Accept","X-Requested-With","X-Inertia","X-Inertia-Partial-Component","component","X-Inertia-Partial-Data","join","X-Inertia-Version","onUploadProgress","progress","percentage","Math","round","loaded","total","_this4","Promise","reject","props","responseUrl","isCancel","locationUrl","get","prop","includes","console","warn","resolve","_this5","pushState","_this6","options","post","put","patch","remember","key","restore","_window$history$state5","_window$history$state6","name","dispatchEvent","CustomEvent","on","callback","defaultPrevented","preventDefault","isContentEditable","which","altKey","ctrlKey","metaKey","shiftKey"],"mappings":"2RAAA,MAAe,CACbA,MAAO,KACPC,SAAU,KAEVC,cAAKC,cACiB,iBAATA,IACTA,gHAAqHC,KAAKC,UAAUF,IAGtI,IAAIG,EAAOC,SAASC,cAAc,QAClCF,EAAKG,UAAYN,EACjBG,EAAKI,iBAAiB,KAAKC,QAAQ,SAAAC,UAAKA,EAAEC,aAAa,SAAU,UAEjEC,KAAKd,MAAQO,SAASC,cAAc,OACpCM,KAAKd,MAAMe,MAAMC,SAAW,QAC5BF,KAAKd,MAAMe,MAAME,MAAQ,QACzBH,KAAKd,MAAMe,MAAMG,OAAS,QAC1BJ,KAAKd,MAAMe,MAAMI,QAAU,OAC3BL,KAAKd,MAAMe,MAAMK,UAAY,aAC7BN,KAAKd,MAAMe,MAAMM,gBAAkB,oBACnCP,KAAKd,MAAMe,MAAMO,OAAS,IAC1BR,KAAKd,MAAMuB,iBAAiB,QAAS,kBAAMC,EAAKC,SAEhD,IAAIC,EAASnB,SAASC,cAAc,UACpCkB,EAAOX,MAAMM,gBAAkB,QAC/BK,EAAOX,MAAMY,aAAe,MAC5BD,EAAOX,MAAME,MAAQ,OACrBS,EAAOX,MAAMG,OAAS,OACtBJ,KAAKd,MAAM4B,YAAYF,GAEvBnB,SAASsB,KAAKC,QAAQhB,KAAKd,OAC3BO,SAASsB,KAAKd,MAAMgB,SAAW,SAC/BL,EAAOM,cAAczB,SAAS0B,OAC9BP,EAAOM,cAAczB,SAAS2B,MAAM5B,EAAK6B,WACzCT,EAAOM,cAAczB,SAAS6B,QAE9BtB,KAAKb,SAAWa,KAAKuB,aAAaC,KAAKxB,MACvCP,SAASgB,iBAAiB,UAAWT,KAAKb,WAG5CwB,gBACEX,KAAKd,MAAMmC,UAAY,GACvBrB,KAAKd,MAAQ,KACbO,SAASsB,KAAKd,MAAMgB,SAAW,UAC/BxB,SAASgC,oBAAoB,UAAWzB,KAAKb,WAG/CoC,sBAAaG,GACW,KAAlBA,EAAMC,SACR3B,KAAKW,yBC7CI,CACbiB,iBAAkB,KAClBC,cAAe,KACfC,eAAgB,KAChBC,YAAa,KACbC,QAAS,KACTxC,KAAM,KAENyC,qBAAOC,IAAAA,YAA+BL,IAAAA,cAAeC,IAAAA,eACnD9B,KAAK4B,mBADaA,iBAElB5B,KAAK6B,cAAgBA,EACrB7B,KAAK8B,eAAiBA,EACtB9B,KAAKmC,uBAAuBD,GAC5BlC,KAAKoC,uBAGPD,gCAAuB3C,GACjBQ,KAAKqC,qBACPrC,KAAKsC,uBAAuB9C,GACnBQ,KAAKuC,kBACdvC,KAAKwC,oBAAoBhD,IAEzBA,EAAKiD,KAAOC,OAAOC,SAASC,KAC5B5C,KAAK6C,QAAQrD,IAEfQ,KAAK8C,UAAU,WAAY,CAAEC,OAAQ,CAAEvD,KAAMA,MAG/C4C,mCChC+BY,EAC3BC,EDgCFP,OAAOjC,iBAAiB,WAAYT,KAAKkD,oBAAoB1B,KAAKxB,OAClEP,SAASgB,iBAAiB,UClCGuC,EDkCgBhD,KAAKmD,kBAAkB3B,KAAKxB,MCjCvEiD,EAAY,uCAEdG,aAAaH,GACbA,EAAYI,WAAW,kBAAML,EAAGM,MAAM5C,EAAM6C,ID8BoC,QAAM,IAGxFC,yBACE,OAAO/D,SAASG,iBAAiB,oBAGnCuD,2BAAkBzB,GACyB,mBAA9BA,EAAM+B,OAAOC,cAA+BhC,EAAM+B,OAAOC,aAAa,kBAC/E1D,KAAK2D,uBAITA,+BACE3D,KAAK4D,kBACA5D,KAAKR,MACRgE,cAAeK,MAAMC,UAAUC,MAAMC,KAAKhE,KAAKwD,iBAAiBS,IAAI,SAAAC,GAClE,MAAO,CACLC,IAAKD,EAAOE,UACZC,KAAMH,EAAOI,kBAMrBC,sCACE9E,SAAS+E,gBAAgBJ,UAAY,EACrC3E,SAAS+E,gBAAgBF,WAAa,EACtCtE,KAAKwD,gBAAgB3D,QAAQ,SAAAqE,GAC3BA,EAAOE,UAAY,EACnBF,EAAOI,WAAa,IAEtBtE,KAAK2D,sBAEDjB,OAAOC,SAASC,gBAClBnD,SAASgF,eAAe/B,OAAOC,SAASC,KAAKmB,MAAM,QAAKW,mBAI5DC,6CACM3E,KAAKR,KAAKgE,eACZxD,KAAKwD,gBAAgB3D,QAAQ,SAACqE,EAAQU,GACpCV,EAAOE,UAAY1D,EAAKlB,KAAKgE,cAAcoB,GAAOT,IAClDD,EAAOI,WAAa5D,EAAKlB,KAAKgE,cAAcoB,GAAOP,QAKzDhC,8BACE,OAAOK,OAAOmC,QAAQC,OACjBpC,OAAOqC,aACPrC,OAAOqC,YAAYC,iBAAiB,cAAcC,QACY,iBAA9DvC,OAAOqC,YAAYC,iBAAiB,cAAc,GAAGE,MAG5D5C,gCAAuB9C,cACrBkD,OAAOmC,QAAQC,MAAMK,QAAU3F,EAAK2F,QACpCnF,KAAK6C,QAAQH,OAAOmC,QAAQC,MAAO,CAAEM,gBAAgB,IAAQC,KAAK,WAChEC,EAAKX,4BAITY,uBAAc9C,EAAK2C,GACjB,IACE1C,OAAO8C,eAAeC,QAAQ,uBAAwBnG,KAAKC,UAAU,CAAE6F,eAAAA,KACvE1C,OAAOC,SAAS+C,KAAOjD,EAAIiD,KACvB1F,KAAK2F,eAAejD,OAAOC,UAAU+C,OAAS1F,KAAK2F,eAAelD,GAAKiD,MACzEhD,OAAOC,SAASiD,SAElB,MAAOC,GACP,WAIJtD,2BACE,IACE,OAAiE,OAA1DG,OAAO8C,eAAeM,QAAQ,wBACrC,MAAOD,GACP,WAIJrD,6BAAoBhD,sBACZ+F,EAAgBjG,KAAKyG,MAAMrD,OAAO8C,eAAeM,QAAQ,yBAC/DpD,OAAO8C,eAAeQ,WAAW,wBACjCxG,EAAKiD,KAAOC,OAAOC,SAASC,KAC5BpD,EAAKyG,kCAAkBvD,OAAOmC,QAAQC,cAAfoB,EAAsBD,mBAAmB,GAChEzG,EAAKgE,gCAAgBd,OAAOmC,QAAQC,cAAfqB,EAAsB3C,iBAAiB,GAC5DxD,KAAK6C,QAAQrD,EAAM,CAAE4F,eAAgBG,EAAcH,iBAAkBC,KAAK,WACpEE,EAAcH,gBAChBgB,EAAKzB,4BAKX0B,iCAAwBC,GACtB,OAAOA,GAAgC,MAApBA,EAASC,QAAkBD,EAASE,QAAQ,uBAGjEC,2BAAkBH,GAChB,aAAOA,SAAAA,EAAUE,QAAQ,cAG3BE,8BACM1G,KAAK+B,aACP/B,KAAK+B,YAAY4E,SAEnB3G,KAAK+B,YAAc6E,EAAMC,YAAYC,UAGvCC,yBAEE,OADA/G,KAAKgC,QAAU,QACHA,SAGdgF,sBAAavE,GACX,IACE,OAAIA,EAAIwE,WAAW,SACNC,OAAOlH,KAAK2F,eAAejD,OAAOC,UAAYF,OAE9CyE,IAAIzE,GAEjB,MAAOoD,GACP,WAAWqB,OAAOxE,OAAOC,SAASwE,OAAS1E,KAI/CkD,wBAAelD,GAGb,OAFAA,EAAM,IAAIyE,IAAIzE,EAAIiD,OACd9C,KAAO,GACJH,GAGT2E,eAAM3E,6BAcF,SAbF4E,OAAAA,aAAS,YACTC,KAAAA,aAAO,SACPC,QAAAA,oBACAnC,eAAAA,oBACAoC,cAAAA,oBACAC,KAAAA,aAAO,SACPjB,QAAAA,aAAU,SACVkB,cAAAA,aAAgB,iBAAO,UACvBC,QAAAA,aAAU,iBAAO,UACjBC,WAAAA,aAAa,iBAAO,UACpBC,SAAAA,aAAW,iBAAO,UAClBC,SAAAA,aAAW,iBAAO,UAClBC,UAAAA,aAAY,iBAAO,MAGfX,KAAU3E,IADdA,EAAMzC,KAAKgH,aAAavE,IACFc,UAAU,IAChC,IAAuB,IAAnBoE,EAAQP,IAAqBpH,KAAK8C,UAAU,QAAS,CAAEkF,YAAY,EAAMjF,OAAQ,CAAEqE,MAAAA,KAAvF,CAGApH,KAAK0G,qBACL1G,KAAK2D,sBACL,IAAI3B,EAAUhC,KAAK+G,gBAGnB,OAFAW,EAAc1H,KAAK+B,iBAERkG,MACTrB,EAAM,CACJS,OAAAA,EACA5E,IAAKzC,KAAK2F,eAAelD,GAAKiD,KAC9B4B,KAA+B,QAAzBD,EAAOa,cAA0B,GAAKZ,EAC5Ca,OAAiC,QAAzBd,EAAOa,cAA0BZ,EAAO,GAChDvF,YAAa/B,KAAK+B,YAAYqG,MAC9B5B,aACKA,GACH6B,OAAQ,mCACRC,mBAAoB,iBACpBC,aAAa,GACTd,EAAKxC,OAAS,CAChBuD,8BAA+BxI,KAAKR,KAAKiJ,UACzCC,yBAA0BjB,EAAKkB,KAAK,MAClC,GACA3I,KAAKR,KAAK2F,QAAU,CAAEyD,oBAAqB5I,KAAKR,KAAK2F,SAAY,IAEvE0D,iBAAkB,SAAAC,GAChBA,EAASC,WAAaC,KAAKC,MAAMH,EAASI,OAASJ,EAASK,MAAQ,KACpEC,EAAKtG,UAAU,WAAY,CAAEC,OAAQ,CAAE+F,SAAAA,KACvClB,EAAWkB,MAEZzD,KAAK,SAAAiB,GACN,IAAK8C,EAAK3C,kBAAkBH,GAC1B,OAAO+C,QAAQC,OAAO,CAAEhD,SAAAA,IAEtBmB,EAAKxC,QAAUqB,EAASgB,KAAKmB,YAAcW,EAAK5J,KAAKiJ,YACvDnC,EAASgB,KAAKiC,WAAaH,EAAK5J,KAAK+J,MAAUjD,EAASgB,KAAKiC,QAE/D,IAAMC,EAAcJ,EAAKpC,aAAaV,EAASgB,KAAK7E,KAKpD,OAJIA,EAAIG,OAAS4G,EAAY5G,MAAQwG,EAAKzD,eAAelD,GAAKiD,OAAS8D,EAAY9D,OACjF8D,EAAY5G,KAAOH,EAAIG,KACvB0D,EAASgB,KAAK7E,IAAM+G,EAAY9D,MAE3B0D,EAAKvG,QAAQyD,EAASgB,KAAM,CAAEtF,QAAAA,EAASuF,QAAAA,EAASnC,eAAAA,EAAgBoC,cAAAA,MACtEnC,KAAK,WAEN,OADA+D,EAAKtG,UAAU,UAAW,CAAEC,OAAQ,CAAEvD,KAAM4J,EAAK5J,QAC1CuI,EAAUqB,EAAK5J,cACf,SAAAqG,GACP,GAAIuD,EAAK3C,kBAAkBZ,EAAMS,UAC/B,OAAO8C,EAAKvG,QAAQgD,EAAMS,SAASgB,KAAM,CAAEtF,QAAAA,OAClC4E,EAAM6C,SAAS5D,GACxBiC,YACSsB,EAAK/C,wBAAwBR,EAAMS,UAAW,CACvD,IAAIoD,EAAcN,EAAKpC,aAAanB,EAAMS,SAASE,QAAQ,uBACvD/D,EAAIG,OAAS8G,EAAY9G,MAAQwG,EAAKzD,eAAelD,GAAKiD,OAASgE,EAAYhE,OACjFgE,EAAY9G,KAAOH,EAAIG,MAEzBwG,EAAK7D,cAAcmE,EAAatE,YACvBS,EAAMS,SAKf,OAAO+C,QAAQC,OAAOzD,GAJlBuD,EAAKtG,UAAU,UAAW,CAAEkF,YAAY,EAAMjF,OAAQ,CAAEuD,SAAUT,EAAMS,aAC1EpH,EAAME,KAAKyG,EAAMS,SAASgB,eAKvB,SAAAzB,GACP,GAAIuD,EAAKtG,UAAU,QAAS,CAAEkF,YAAY,EAAMjF,OAAQ,CAAE8C,MAAAA,KACxD,OAAOwD,QAAQC,OAAOzD,aAEf,WACTuD,EAAKtG,UAAU,UACf+E,MACE,CACF8B,IAAK,SAASlG,EAAQmG,GAIpB,MAHI,CAAC,OAAQ,QAAS,WAAWC,SAASD,IACxCE,QAAQC,KAAK,sNAEgB,mBAAjBtG,EAAOmG,GACjBnG,EAAOmG,GAAMpI,KAAKiC,GAClBA,EAAOmG,QAMnB/G,iBAAQrD,6BAA2G,SAAnGwC,QAAAA,aAAUhC,KAAK+G,sBAAiBQ,QAAAA,oBAAiBnC,eAAAA,oBAAwBoC,cAAAA,gBACvF,OAAO6B,QAAQW,QAAQhK,KAAK4B,iBAAiBpC,EAAKiJ,YAAYpD,KAAK,SAAAoD,GAC7DzG,IAAYiI,EAAKjI,UACnBxC,EAAK+J,MAAQU,EAAKnI,eAAetC,EAAK+J,OACtC/J,EAAKgE,cAAgBhE,EAAKgE,eAAiB,GAC3ChE,EAAKyG,gBAAkBzG,EAAKyG,iBAAmB,GAC/CuB,EAAyC,mBAAlBA,EAA+BA,EAAchI,GAAQgI,EAC5EpC,EAA2C,mBAAnBA,EAAgCA,EAAe5F,GAAQ4F,GAC/EmC,EAAUA,GAAW0C,EAAKjD,aAAaxH,EAAKiD,KAAKiD,OAAShD,OAAOC,SAAS+C,MAChEuE,EAAKrG,aAAapE,GAAQyK,EAAKC,UAAU1K,GACnDyK,EAAKpI,cAAc,CAAE4G,UAAAA,EAAWjJ,KAAAA,EAAMgI,cAAAA,IAAiBnC,KAAK,WACrDD,GACH6E,EAAK1F,uBAEFgD,GACH0C,EAAKnH,UAAU,WAAY,CAAEC,OAAQ,CAAEvD,KAAMA,WAOvD0K,mBAAU1K,GACRQ,KAAKR,KAAOA,EACZkD,OAAOmC,QAAQqF,UAAU1K,EAAM,GAAIA,EAAKiD,MAG1CmB,sBAAapE,GACXQ,KAAKR,KAAOA,EACZkD,OAAOmC,QAAQjB,aAAapE,EAAM,GAAIA,EAAKiD,MAG7CS,6BAAoBxB,cAClB,GAAoB,OAAhBA,EAAMoD,MAAgB,CACxB,IAAMtF,EAAOkC,EAAMoD,MACf9C,EAAUhC,KAAK+G,gBACnB,OAAOsC,QAAQW,QAAQhK,KAAK4B,iBAAiBpC,EAAKiJ,YAAYpD,KAAK,SAAAoD,GAC7DzG,IAAYmI,EAAKnI,UACnBmI,EAAK3K,KAAOA,EACZ2K,EAAKtI,cAAc,CAAE4G,UAAAA,EAAWjJ,KAAAA,EAAMgI,eAAe,IAASnC,KAAK,WACjE8E,EAAKxF,yBACLwF,EAAKrH,UAAU,WAAY,CAAEC,OAAQ,CAAEvD,KAAMA,UAKnD,IAAMiD,EAAMzC,KAAKgH,aAAahH,KAAKR,KAAKiD,KACxCA,EAAIG,KAAOF,OAAOC,SAASC,KAC3B5C,KAAK4D,kBAAkB5D,KAAKR,MAAMiD,IAAKA,EAAIiD,QAC3C1F,KAAKuE,wBAIToF,aAAIlH,EAAK6E,EAAW8C,GAClB,gBADO9C,IAAAA,EAAO,aAAI8C,IAAAA,EAAU,SAChBhD,MAAM3E,OAAU2H,GAAS/C,OAAQ,MAAOC,KAAAA,MAGtD1B,gBAAOwE,GACL,gBADKA,IAAAA,EAAU,SACH7C,QAAQ7E,OAAOC,SAAS+C,KAAM0E,IAG5C7C,iBAAQ9E,EAAK2H,GACX,gBADWA,IAAAA,EAAU,SACThD,MAAM3E,KAAO+E,eAAe,GAAS4C,GAAS7C,SAAS,MAGrE8C,cAAK5H,EAAK6E,EAAW8C,GACnB,gBADQ9C,IAAAA,EAAO,aAAI8C,IAAAA,EAAU,SACjBhD,MAAM3E,KAAO+E,eAAe,GAAS4C,GAAS/C,OAAQ,OAAQC,KAAAA,MAG5EgD,aAAI7H,EAAK6E,EAAW8C,GAClB,gBADO9C,IAAAA,EAAO,aAAI8C,IAAAA,EAAU,SAChBhD,MAAM3E,KAAO+E,eAAe,GAAS4C,GAAS/C,OAAQ,MAAOC,KAAAA,MAG3EiD,eAAM9H,EAAK6E,EAAW8C,GACpB,gBADS9C,IAAAA,EAAO,aAAI8C,IAAAA,EAAU,SAClBhD,MAAM3E,KAAO+E,eAAe,GAAS4C,GAAS/C,OAAQ,QAASC,KAAAA,sBAGtE7E,EAAK2H,GACV,gBADUA,IAAAA,EAAU,SACRhD,MAAM3E,KAAO+E,eAAe,GAAS4C,GAAS/C,OAAQ,aAGpEmD,kBAASlD,EAAMmD,kBAAAA,IAAAA,EAAM,WACnBzK,KAAK4D,kBACA5D,KAAKR,MACRyG,qBACKjG,KAAKR,KAAKyG,wBACZwE,GAAMnD,UAKboD,iBAAQD,WACN,gBADMA,IAAAA,EAAM,oBACL/H,OAAOmC,QAAQC,iBAAf6F,EAAsB1E,wBAAtB2E,EAAwCH,IAGjD3H,mBAAU+H,EAAMT,GACd,OAAO3K,SAASqL,cACd,IAAIC,uBAAuBF,EAAQT,KAIvCY,YAAG9F,EAAM+F,GACP,IAAM9L,EAAW,SAAAuC,GACf,IAAM4E,EAAW2E,EAASvJ,GACtBA,EAAMsG,aAAetG,EAAMwJ,mBAAiC,IAAb5E,GACjD5E,EAAMyJ,kBAKV,OADA1L,SAASgB,4BAA4ByE,EAAQ/F,qBAChCM,SAASgC,+BAA+ByD,EAAQ/F,uCE3XzBuC,GACtC,QACGA,EAAM+B,QAAU/B,EAAM+B,OAAO2H,mBAC3B1J,EAAMwJ,kBACNxJ,EAAM2J,MAAQ,GACd3J,EAAM4J,QACN5J,EAAM6J,SACN7J,EAAM8J,SACN9J,EAAM+J"}